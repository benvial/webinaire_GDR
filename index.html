<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-bcc9160bb27a95f09fb05d98860f9772.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Benjamin Vial">
  <title>webinaire_GDR – Optimization of Photonic Devices: Implementation of Auto-Differentiable Numerical Methods in Open-Source Software</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #3d7f7a; } /* Attribute */
    code span.bn { color: #0c5da5; } /* BaseN */
    code span.bu { color: #3d7f7a; } /* BuiltIn */
    code span.cf { color: #3d7f7a; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #0c5da5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #3d7f7a; } /* DataType */
    code span.dv { color: #0c5da5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #3d7f7a; font-weight: bold; } /* Extension */
    code span.fl { color: #0c5da5; } /* Float */
    code span.fu { color: #a04747; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #3d7f7a; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #a04747; } /* Other */
    code span.pp { color: #3d7f7a; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #0c5da5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #034c95; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-cdeedea4813fabbf2b34a4c373a6b0c2.css">
  <link rel="stylesheet" href="custom.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="fig/bg.svg" class="quarto-title-block center">
  <h1 class="title"><p>Optimization of Photonic Devices: Implementation of Auto-Differentiable Numerical Methods in Open-Source Software</p></h1>
  <p class="subtitle">Séminaire GDR Ondes</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Benjamin Vial 
</div>
        <p class="quarto-title-affiliation">
            Imperial College London
          </p>
    <div class="quarto-title-author-email">
<a href="mailto:b.vial@imperial.ac.uk">b.vial@imperial.ac.uk</a>
</div>
</div>
</div>

</section>
<section>
<section id="introduction" class="title-slide slide level1 center" data-background-color="var(--quarto-scss-export-green)">
<h1>Introduction</h1>

</section>
<section id="introduction-1" class="slide level2">
<h2>Introduction</h2>
<div style="display: none;">
<p><span class="math display">\[
\usepackage{amsmath,amssymb}
\newcommand{\e}{\varepsilon}
\newcommand{\exx}{\e_{xx}}
\newcommand{\eyy}{\e_{yy}}
\newcommand{\ea}{\e_{a}}
\newcommand{\ezz}{\e_{zz}}
\newcommand{\exy}{\e_{xy}}
\newcommand{\eyx}{\e_{yx}}
\newcommand{\muxx}{\mu_{xx}}
\newcommand{\muyy}{\mu_{yy}}
\newcommand{\mua}{\mu_{a}}
\newcommand{\muzz}{\mu_{zz}}
\newcommand{\ef}{\e_{\rm f}}
\newcommand{\ed}{\e_{\rm d}}
\newcommand{\tdf}{\tan \delta_{\rm f}}
\newcommand{\td}{\tan \delta}
\newcommand{\Eb}{E_{\rm B}}
\newcommand{\Em}{\B{\mathcal{E}}}
\newcommand{\Hm}{{\mathcal{H}}}
\usepackage{bm}
\newcommand{\B}[1]{\boldsymbol{#1}}
\newcommand{\tens}[1]{\B{#1}}
\newcommand{\re}{\mathrm{Re}\,}
\newcommand{\im}{\mathrm{Im}\,}
\newcommand{\grad}{\B{\nabla}}
\newcommand{\ddiv}{\B{\nabla}\cdotp}
\newcommand{\curl}{\B{\nabla}\times}
\newcommand{\dt}{\mathrm{d}}
\newcommand{\etens}{\tens{\e}}
\newcommand{\h}[1]{\tilde{#1}}
\newcommand{\T}[1]{#1^{\rm T}}
\newcommand{\lp}{\left(}
\newcommand{\rp}{\right)}
\newcommand{\bra}{\left\langle}
\newcommand{\ket}{\right\rangle}
\newcommand{\mn}[1]{\bra #1 \ket}
\newcommand{\D}{\partial}
\newcommand{\dd}{\rm d}
\newcommand{\der}[2]{\frac{\D #1}{\D #2}}
\newcommand{\rhof}{\tilde{\rho}}
\newcommand{\rhop}{\hat{\rho}}
\newcommand{\matthree}[9]{
\begin{pmatrix}
#1 &amp; #2 &amp; #3\\
#4 &amp; #5 &amp; #6\\
#7 &amp; #8 &amp; #9
\end{pmatrix}
}
\newcommand{\ehom}{\tilde{\etens}}
\newcommand{\ezaniso}{\matthree{\exx}{\ea^\star}{0}{\ea}{\eyy}{0}{0}{0}{\ezz}}
\newcommand{\muzaniso}{\matthree{\muxx}{\mua^\star}{0}{\mua}{\muyy}{0}{0}{0}{\muzz}}
\newcommand{\LSO}{L^2({{\rm\textbf{curl}}}, \Omega)}
\newcommand{\rpara}{\B{r_\parallel}}
\newcommand{\densf}{\tilde{p}}
\newcommand{\densp}{\hat{p}}
\newcommand{\exxh}{\h{\e}_{xx}}
\newcommand{\eyyh}{\h{\e}_{yy}}
\newcommand{\exyh}{\h{\e}_{xy}}
\newcommand{\eyxh}{\h{\e}_{yx}}
\newcommand{\ezzh}{\h{\e}_{zz}}
\newcommand{\tdhxx}{\tan \h{\delta}_{xx}}
\newcommand{\tunh}{\h{\eta}}
\]</span></p>
</div>
<p>What is topology optimization?</p>
<blockquote>
<div style="font-size: 100%;">
A mathematical method that optimizes material layout within a given design space, for a given set of sources, boundary conditions and constraints with the goal of maximizing the performance of the system
</div>
</blockquote>
</section>
<section id="section" class="slide level2" data-background-image="https://comet-fenics.readthedocs.io/en/latest/_images/cantilever_beam.gif">
<h2></h2>
<div style="font-size: 90%; margin-left: 10%; margin-top: 80vh">
<p>Topology optimization <code>Hello World!</code>: Maximizing a beam stiffness with fixed volume fraction <span class="citation" data-cites="bleyer2018numericaltours">(<a href="#/bibliography" role="doc-biblioref" onclick="">Bleyer 2018</a>)</span></p>
</div>
</section>
<section id="section-1" class="slide level2" data-background-color="black" data-background-image="https://static.wixstatic.com/media/1790be_4a51fb50cb784a9da928ac9ef248dc03~mv2.jpg" data-background-opacity="1">
<h2></h2>
<div style="text-transform: uppercase">
Structural Engineering
</div>
<div style="font-size: 70%">
Qatar National Convention Centre
</div>
</section>
<section id="section-2" class="slide level2" data-background-color="black" data-background-image="fig/wing.webp" data-background-opacity="0.5">
<h2></h2>
<div style="padding-top: 26vh;">
<div class="up">
Aeronautics
</div>
<div style="font-size: 70%;">
Airplane wing <span class="citation" data-cites="aageGigavoxelComputationalMorphogenesis2017">(<a href="#/bibliography" role="doc-biblioref" onclick="">Aage et al. 2017</a>)</span>
</div>
</div>
</section>
<section id="section-3" class="slide level2" data-background-image="fig/history_opt_phot.webp" data-background-opacity="1" data-background-size="90%" data-background-repeat="no-repeat">
<h2></h2>
<div style="padding-top:130px;padding-left:30%;">
<div style=" text-transform: uppercase; color:var(--quarto-scss-export-primary-color);">
Photonics
</div>
<p><span class="citation" data-cites="moleskyInverseDesignNanophotonics2018">(<a href="#/bibliography" role="doc-biblioref" onclick="">Molesky et al. 2018</a>)</span></p>
</div>
</section>
<section id="topology-optimization-recipes" class="slide level2">
<h2>Topology optimization: recipes</h2>
<div>
<ul>
<li class="fragment"><div class="up">
Density function
</div>
<span class="math inline">\(p \in [0,1]\)</span>: material distribution in design domain <span class="math inline">\(\Omega_{\rm des}\)</span></li>
<li class="fragment"><div class="up">
Filtering
</div>
Convolution: <span class="math inline">\(f(\B r) = \frac{1}{A}{\rm exp}(-|\B r|^2 /R_f^2)\)</span>, with <span class="math inline">\(\int_{\Omega_{\rm des}} f(\B r) =1\)</span> <span class="math display">\[\begin{equation*}
\densf(\B r)  = p * f = \int_{\Omega_{\rm des}} p(\B r') f(\B r -\B r') {\rm d} \B r'
\label{eq:gaussian_filt}
\end{equation*}\]</span> PDE: <span class="math inline">\(-R_f^2 \B\nabla ^2 \densf + \densf = p {\quad\rm on \,}\Omega_{\rm des}, \grad\densf\cdotp\B n = 0 {\quad\rm on \,}\partial\Omega_{\rm des}\)</span> <span class="citation" data-cites="lazarovFiltersTopologyOptimization2011">(<a href="#/bibliography" role="doc-biblioref" onclick="">Lazarov et al. 2011</a>)</span> <img src="fig/filter.gif" style="width: 62%; padding-top: 24px;"></li>
</ul>
</div>
</section>
<section id="topology-optimization-recipes-1" class="slide level2">
<h2>Topology optimization: recipes</h2>
<div>
<ul>
<li class="fragment"><div class="up">
Projection
</div>
<p><span class="math display">\[\densp(\densf) = \frac{\tanh\left[\beta\nu\right] + \tanh\left[\beta(\densf-\nu)\right] }{\tanh\left[\beta\nu\right]
+ \tanh\left[\beta(1-\nu)\right]}\]</span> with <span class="math inline">\(\nu=1/2\)</span> and <span class="math inline">\(\beta&gt;0\)</span> increased during the course of the optimization. <span class="citation" data-cites="wangProjectionMethodsConvergence2010">(<a href="#/bibliography" role="doc-biblioref" onclick="">Wang et al. 2010</a>)</span> <img src="fig/proj.gif" style="width: 65%; padding-top: 24px;"></p></li>
<li class="fragment"><div class="up">
Interpolation
</div>
<p><span class="math inline">\(\varepsilon(\densp)=(\varepsilon_{\rm max}-\varepsilon_{\rm min})\,\densp^m + \varepsilon_{\rm min}\)</span> <span class="citation" data-cites="bendsoeMaterialInterpolationSchemes1999">(<a href="#/bibliography" role="doc-biblioref" onclick="">Bendsøe et al. 1999</a>)</span></p></li>
</ul>
</div>
</section>
<section id="algorithm" class="slide level2">
<h2>Algorithm</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="fig/topopt_algo.png" style="width:80.0%"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><div class="up">
gradient based optimization algorithm
</div>
method of moving asymptotes <span class="citation" data-cites="svanbergClassGloballyConvergent">(<a href="#/bibliography" role="doc-biblioref" onclick="">Svanberg 2002</a>)</span>, free implementation via the <code>nlopt</code> package <span class="citation" data-cites="johnsonNLoptNonlinearoptimizationPackage">(<a href="#/bibliography" role="doc-biblioref" onclick="">Johnson 2007</a>)</span></li>
<li>40 iterations or until convergence on the objective or design variables</li>
<li>repeated setting <span class="math inline">\(\beta =2^n\)</span>, where <span class="math inline">\(n\)</span> is an integer between 0 and 7, restarting the algorithm with the optimized density obtained at the previous step</li>
</ul>
<p><img data-src="fig/opt_landscape.png" style="width:80.0%"></p>
</div></div>
</section></section>
<section>
<section id="computing-gradients" class="title-slide slide level1 center" data-background-color="var(--quarto-scss-export-blue)">
<h1>Computing gradients</h1>

</section>
<section id="computing-gradients-1" class="slide level2">
<h2>Computing gradients</h2>
<p>Solution vector <span class="math inline">\(\B u\)</span> depends on a vector of parameters <span class="math inline">\(\B p\)</span> of size <span class="math inline">\(M\)</span> and defined implicitly through an operator <span class="math inline">\(\B F\)</span> as: <span id="eq-genimpeq"><span class="math display">\[
\B F(\B u, \B p) = \B 0
\qquad(1)\]</span></span></p>
<p><span class="math inline">\(\B G\)</span> is a functional of interest of dimension <span class="math inline">\(N\)</span>, representing the quantity to be optimized</p>
<div class="fragment">
<h3 id="finite-differences">Finite differences</h3>
<p><span class="math display">\[
\frac{\mathrm{d}\B G}{\mathrm{d}p_i} \approx \frac{\B G(\B p + h \B e_i) - \B G(\B p)}{h}
\]</span> where <span class="math inline">\(\B e_i\)</span> is the vector with <span class="math inline">\(0\)</span> in all entries except for <span class="math inline">\(1\)</span> in the <span class="math inline">\(i^{th}\)</span> entry.</p>
<ul>
<li>numerical inaccuracy</li>
<li>expensive for large <span class="math inline">\(M\)</span> and/or <span class="math inline">\(N\)</span></li>
</ul>
</div>
</section>
<section id="computing-gradients-2" class="slide level2">
<h2>Computing gradients</h2>
<h3 id="tangent-linear-equation">Tangent linear equation</h3>
<p>Explicitly, the gradient can be computed applying the chain rule: <span id="eq-gradG"><span class="math display">\[
\frac{\mathrm{d}\B G}{\mathrm{d}\B p} =
\frac{\partial \B G}{\partial \B p} +
\frac{\partial \B G}{\partial \B u}
\frac{\mathrm{d}\B u}{\mathrm{d}\B p}.
\qquad(2)\]</span></span> Taking the total derivative of <a href="#/eq-genimpeq" class="quarto-xref">Equation&nbsp;1</a> we obtain the tangent linear equation: <span class="math display">\[
{\frac{\partial \B F(\B u, \B p)}{\partial \B u}}
{\frac{\mathrm{d}\B u}{\mathrm{d}\B p}} =
{-\frac{\partial \B F(\B u, \B p)}{\partial \B p}}.
\]</span></p>
<div class="fragment">
<h3 id="adjoint-equation">Adjoint equation</h3>
<p>Assuming the tangent linear system is invertible, we can rewrite the Jacobian as: <span class="math display">\[
\frac{\mathrm{d}\B u}{\mathrm{d}\B p} = - \left(\frac{\partial \B F(\B u, \B p)}{\partial \B u}\right)^{-1}
\frac{\partial \B F(\B u, \B p)}{\partial \B p}.
\]</span> After substituting this value in <a href="#/eq-gradG" class="quarto-xref">Equation&nbsp;2</a> and taking the adjoint (Hermitian transpose, denoted by <span class="math inline">\(\dagger\)</span>) we get: <span class="math display">\[
    \frac{\mathrm{d}\B G}{\mathrm{d}\B p}^{\dagger} =
    \frac{\partial \B G}{\partial \B p}^{\dagger}
    - \frac{\partial \B F(\B u, \B p)}{\partial \B p}^{\dagger} \left(\frac{\partial \B F(\B u, \B p)}{\partial \B u}\right)^{-\dagger}
    \frac{\partial \B G}{\partial \B u}^{\dagger} .
\]</span></p>
</div>
</section>
<section id="computing-gradients-3" class="slide level2">
<h2>Computing gradients</h2>
<h3 id="adjoint-equation-1">Adjoint equation</h3>
<p>Defining the adjoint variable <span class="math inline">\(\B \lambda\)</span> as: <span class="math display">\[
\B \lambda = \left(\frac{\partial \B F(\B u, \B p)}{\partial \B u}\right)^{-\dagger}
\frac{\partial \B G}{\partial \B u}^{\dagger}
\]</span> we obtain the adjoint equation <span class="math display">\[
    \left(\frac{\partial \B F(\B u, \B p)}{\partial \B u}\right)^{\dagger} \B \lambda = \frac{\partial \B G}{\partial \B u}^{\dagger}.
\]</span></p>
</section>
<section id="automatic-differentiation-ad" class="slide level2">
<h2>Automatic differentiation (AD)</h2>
<ul>
<li>A general way of taking a program which computes a value, and automatically constructing a procedure for computing derivatives of that value, accurately to working precision, and using at most a small constant factor more arithmetic operations than the original program <span class="citation" data-cites="griewankEvaluatingDerivatives2008">(<a href="#/bibliography" role="doc-biblioref" onclick="">Griewank et al. 2008</a>)</span></li>
</ul>
<div>
<ul>
<li class="fragment">Not finite differences / symbolic differentiation</li>
<li class="fragment">Procedure:
<ol type="1">
<li class="fragment">Decompose original code into intrinsic functions (build computational graph)</li>
<li class="fragment">Differentiate the intrinsic functions, effectively symbolically</li>
<li class="fragment">Multiply together according to the chain rule</li>
</ol></li>
<li class="fragment">Automation:
<ul>
<li class="fragment">Source code transformation</li>
<li class="fragment">Operator overloading</li>
</ul></li>
</ul>
</div>
</section>
<section id="automatic-differentiation-ad-1" class="slide level2">
<h2>Automatic differentiation (AD)</h2>
<p><span class="math inline">\(f: \mathbb{R}^M \rightarrow \mathbb{R}^N\)</span></p>
<p>Example: <span class="math inline">\(f(x_1,x_2) = x_1x_2 + \sin(x_1)\)</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p>Forward mode</p>
<p><img data-src="fig/forward.png"></p>
<ul>
<li>more efficient if <span class="math inline">\(N\gg M\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<p>Reverse mode</p>
<p><img data-src="fig/reverse.png"></p>
<ul>
<li>more efficient if <span class="math inline">\(M \gg N\)</span></li>
<li>need to store intermediate values</li>
</ul>
</div></div>
</section></section>
<section>
<section id="finite-element-method" class="title-slide slide level1 center" data-background-image="https://gyptis.gitlab.io/_static/_assets/bg.svg" data-background-color="black" data-background-opacity="0.25">
<h1>Finite Element Method</h1>
<p>Open-source code</p>
</section>
<section id="finite-element-method-1" class="slide level2">
<h2>Finite Element Method</h2>
<h3 id="implementation">Implementation</h3>
<p>Open source libraries with bindings for the <code>python</code> programming language using a custom code <code>gyptis</code> <span class="citation" data-cites="gyptis042">(<a href="#/bibliography" role="doc-biblioref" onclick="">Vial 2022</a>)</span>.</p>
<ul>
<li>Geometry and mesh generation: <code>gmsh</code> <span class="citation" data-cites="geuzaineGmsh3DFinite2009">(<a href="#/bibliography" role="doc-biblioref" onclick="">Geuzaine et al. 2009</a>)</span></li>
<li>FEM library: <code>fenics</code> using second order Lagrange basis functions <span class="citation" data-cites="alnaesFEniCSProjectVersion2015">(<a href="#/bibliography" role="doc-biblioref" onclick="">Alnæs et al. 2015</a>)</span></li>
<li>Gradient calculations: <code>dolfin-adjoint</code> library with automatic differentiation <span class="citation" data-cites="mituschDolfinadjoint2018Automated2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Mitusch et al. 2019</a>)</span></li>
</ul>
</section>
<section id="gyptis" class="slide level2 hide-title title-slide center" data-background-iframe="https://gyptis.gitlab.io">
<h2>gyptis</h2>
</section>
<section id="finite-element-method-2" class="slide level2">
<h2>Finite Element Method</h2>
<h3 id="application-bi-focal-lens">Application: Bi-focal lens</h3>
<p>Objective: focal point at two different locations depending on the excitation frequency <span class="citation" data-cites="vialOptimizationExperimentalValidation2022">(<a href="#/bibliography" role="doc-biblioref" onclick="">Vial, Whittaker, et al. 2022</a>)</span> <span class="math display">\[
     \max_{p(\B r)} \quad \Phi = \left|E_1(\omega_1,\B r_1)\right| + \left|E_2(\omega_2,\B r_2)\right|
\]</span></p>
<div class="fragment">
<p><img data-src="fig/bifoc/lens.png" class="absolute" style="left: 34%; bottom: 0px; width: 222px; "></p>
<div class="columns">
<div class="column" style="width:50%;">
<h5 id="optimization-history">Optimization history</h5>
<p><img data-src="fig/bifoc/figure1.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="fig/bifoc/figure2.png" class="img" style="width:80.0%"></p>
</div></div>
</div>
</section>
<section id="finite-element-method-3" class="slide level2">
<h2>Finite Element Method</h2>
<h3 id="inverse-design-of-superscatterers">Inverse design of superscatterers</h3>
<p><em>Objective</em>: maximize the normalized scattering width <span class="citation" data-cites="vial2022">(<a href="#/bibliography" role="doc-biblioref" onclick="">Vial and Hao 2022</a>)</span> <span class="math display">\[
\max_{p(\B r)} \quad    \Phi = \sigma_s/2R
\]</span></p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<h5 id="te">TE</h5>
<video data-autoplay="" src="fig/animation_gyptis_TE.mp4" onloadeddata="this.playbackRate=3.0;">
</video>
</div><div class="column" style="width:50%;">
<h5 id="tm">TM</h5>
<video data-autoplay="" src="fig/animation_gyptis_TM.mp4" onloadeddata="this.playbackRate=3.0;">
</video>
</div></div>
</div>
</section>
<section id="finite-element-method-4" class="slide level2">
<h2>Finite Element Method</h2>
<h3 id="inverse-design-of-superscatterers-1">Inverse design of superscatterers</h3>
<div class="columns">
<div class="column" style="width:50%;">
<h5 id="spectra">Spectra</h5>
<p><img data-src="fig/figure1.png"></p>
</div><div class="column" style="width:50%;">
<h5 id="quasi-normal-modes-expansion">Quasi Normal Modes expansion</h5>
<p><img data-src="fig/figure2.png"></p>
</div></div>
</section></section>
<section>
<section id="fourier-modal-method" class="title-slide slide level1 center" data-background-image="https://nannos.gitlab.io/_static/_assets/bg.svg" data-background-color="black" data-background-opacity="0.25">
<h1>Fourier Modal Method</h1>
<p>Open-source code</p>
</section>
<section id="fourier-modal-method-fmm" class="slide level2">
<h2>Fourier Modal Method (FMM)</h2>
<div class="columns">
<div class="column" style="width:55%;">
<ul>
<li>AKA Rigorous Coupled Wave Analysis (RCWA)</li>
<li>Suited for a specific type of periodic structure made up of stacked structured layers</li>
<li><em>Key idea</em>: expand the electromagnetic fields within each layer into eigenmodes represented using a Fourier basis in the plane of periodicity <span class="citation" data-cites="lalanne1996 granet1996 whittakerScatteringmatrixTreatmentPatterned1999 liuS4FreeElectromagnetic2012">(<a href="#/bibliography" role="doc-biblioref" onclick="">Lalanne et al. 1996</a>; <a href="#/bibliography" role="doc-biblioref" onclick="">Granet et al. 1996</a>; <a href="#/bibliography" role="doc-biblioref" onclick="">Whittaker et al. 1999</a>; <a href="#/bibliography" role="doc-biblioref" onclick="">Liu et al. 2012</a>)</span></li>
</ul>
<div class="fragment">
<h3 id="implementation-1">Implementation</h3>
<p>FMM and PWEM in <code>python</code> with various numerical backends for core linear algebra operations and array manipulation</p>
<ul>
<li><code>numpy</code> <span class="citation" data-cites="harris2020array">(<a href="#/bibliography" role="doc-biblioref" onclick="">Harris et al. 2020</a>)</span></li>
<li><code>scipy</code> <span class="citation" data-cites="2020SciPy-NMeth">(<a href="#/bibliography" role="doc-biblioref" onclick="">Virtanen et al. 2020</a>)</span></li>
<li><code>autograd</code> (AD) <span class="citation" data-cites="maclaurin2015autograd">(<a href="#/bibliography" role="doc-biblioref" onclick="">Maclaurin et al. 2015</a>)</span></li>
<li><code>pytorch</code> (AD + GPU) <span class="citation" data-cites="NEURIPS2019_9015 paszke2017automatic">(<a href="#/bibliography" role="doc-biblioref" onclick="">Paszke et al. 2019</a>, <a href="#/bibliography" role="doc-biblioref" onclick="">2017</a>)</span></li>
<li><code>jax</code> (AD + GPU) <span class="citation" data-cites="jax2018github">(<a href="#/bibliography" role="doc-biblioref" onclick="">Bradbury et al. 2018</a>)</span></li>
</ul>
</div>
</div><div class="column" style="width:45%;">
<p><img data-src="fig/metasurface_nannos.png"></p>
</div></div>
</section>
<section id="nannos" class="slide level2 hide-title title-slide center" data-background-iframe="https://nannos.gitlab.io">
<h2>nannos</h2>
</section>
<section id="fmm-benchmark" class="slide level2">
<h2>FMM benchmark</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="fig/speedup1.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="fig/speedup16.png"></p>
</div></div>
</section>
<section id="application-metasurface" class="slide level2">
<h2>Application: metasurface</h2>
<p><em>Objective</em>: maximize the average of the transmission coefficient in the <span class="math inline">\((1,0)\)</span> diffracted order for both polarizations: <span class="math display">\[
        \max_{p(\B r)} \quad    \Phi = \frac{1}{2} \left( T^{\rm TE}_{(1,0)} + T^{\rm TM}_{(1,0)}\right)
\]</span></p>
<div class="fragment">
<video data-autoplay="" src="fig/animation_nannos.mp4" style="width: 150%;" onloadeddata="this.playbackRate=6.0;">
</video>
</div>
</section>
<section id="application-metasurface-1" class="slide level2">
<h2>Application: metasurface</h2>

<img data-src="fig/figure4.png" class="img r-stretch" style="width:100.0%"></section>
<section id="optimized-metasurface" class="slide level2 hide-title" data-background-color="black" data-background-image="fig/metasurface.png">
<h2>Optimized metasurface</h2>
</section></section>
<section>
<section id="plane-wave-expansion-method" class="title-slide slide level1 center" data-background-image="https://protis.gitlab.io/_static/_assets/bg.svg" data-background-color="black" data-background-opacity="0.25">
<h1>Plane Wave Expansion Method</h1>
<p>Open-source code</p>
</section>
<section id="plane-wave-expansion-method-1" class="slide level2">
<h2>Plane Wave Expansion Method</h2>
<ul>
<li>2D, possibly <span class="math inline">\(z\)</span>-anisotropic materials in <span class="math inline">\(\varepsilon\)</span> and <span class="math inline">\(\mu\)</span>, non dispersive</li>
<li>Polarization decouple, expand the <span class="math inline">\(z\)</span> components as: <span class="math display">\[
u(\B{r})=\sum_{\B {G}} u_{\B {G}}\, {\rm e}^{i(\B {k}+\B {G}) \cdot \B{r}},
\label{eq:pwem1}
\]</span></li>
<li>After Fourier transforming Maxwell’s equations and recombining the relevant <span class="math inline">\(z\)</span> component of the fields, we get the following generalized eigenproblem: <span id="eq-pwem2"><span class="math display">\[
\mathcal{Q}^{\rm T} \,\hat{\tens{\theta}_\parallel}^{-1}\,\mathcal{Q}\, \Phi = k_0^2 \,\chi_{zz}\, \Phi
\qquad(3)\]</span></span> <span class="math inline">\(\tens{\theta}_\parallel=\tens{\mu}_\parallel\)</span> for TM and <span class="math inline">\(\tens{\varepsilon}_\parallel\)</span> for TE polarization, <span class="math inline">\(\mathcal{Q} =  \left[\hat{k}_{y}, -\hat{k}_{x}\right]^{\rm T}\)</span> and <span class="math inline">\(\Phi=\left[u_{\B{G}_{1}}, u_{\B{G}_{2}}, \ldots\right]^{\rm T}\)</span></li>
<li>Reduced Bloch Mode Expansion <span class="citation" data-cites="husseinReducedBlochMode2009">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hussein 2009</a>)</span>, only solving <a href="#/eq-pwem2" class="quarto-xref">Equation&nbsp;3</a> at symmetry points of the first Brillouin zone and performing a second expansion using those modes as a basis set.</li>
</ul>
</section>
<section id="protis" class="slide level2 title-slide hide-title center" data-background-iframe="https://protis.gitlab.io">
<h2>protis</h2>
</section>
<section id="photonic-crystals-maximizing-bandgaps" class="slide level2">
<h2>Photonic crystals: maximizing bandgaps</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>TE modes, square array with enforced <span class="math inline">\(C_4\)</span> symmetry on the unit cell, <span class="math inline">\(\varepsilon_{\rm min}=1\)</span> (air) and <span class="math inline">\(\varepsilon_{\rm max}=9\)</span></li>
</ul>
<p>Objective: open and maximize a bandgap between the <span class="math inline">\(5^{th}\)</span> and <span class="math inline">\(6^{th}\)</span> eigenvalues:<span class="math display">\[\begin{equation*}\max_{p(\B r)} \quad    \Phi = \min_{\B k} \omega_{6}(\B k) - \max_{\B k} \omega_{5}(\B k)\end{equation*}\]</span></p>
<ul>
<li>Final distribution in agreement with simple geometrical rules: the walls of an optimal centroidal Voronoi tessellation with <span class="math inline">\(n=5\)</span> points <span class="citation" data-cites="sigmundGeometricPropertiesOptimal2008">(<a href="#/bibliography" role="doc-biblioref" onclick="">Sigmund et al. 2008</a>)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<video data-autoplay="" src="fig/animation_protis_bandgap_TE.mp4">
</video>
</div></div>
</section>
<section id="photonic-crystals-dispersion-engineering" class="slide level2">
<h2>Photonic crystals: dispersion engineering</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>TM modes, symmetry with respect to <span class="math inline">\(y\)</span></li>
</ul>
<p><em>Objective</em>: obtain a prescribed dispersion curve for the <span class="math inline">\(6^{th}\)</span> band <span class="math display">\[\begin{equation*}\min_{p(\B r)} \quad \Phi =  \left\langle\left|\omega_{6}(k_x) - \langle \omega_{6}\rangle - \omega_{\rm tar}(k_x) \right|^2\right\rangle \end{equation*}\]</span> with <span class="math display">\[\begin{align*}\omega_{\rm tar}(k_x) =&amp; -0.02 \cos(k_x  a) + 0.01 \cos(2  k_x a) \\ &amp;+ 0.007 \cos(3  k_x  a)\end{align*}\]</span> <span class="math inline">\(\langle f\rangle =\frac{1}{M}\sum_{m=0}^M f_m\)</span></p>
</div><div class="column" style="width:50%;">
<video data-autoplay="" src="fig/animation_protis_dispersion_TM.mp4">
</video>
</div></div>
</section></section>
<section>
<section id="open-source" class="title-slide slide level1 center" data-background-color="var(--quarto-scss-export-purple)">
<h1>Open source</h1>

</section>
<section id="open-source-1" class="slide level2">
<h2>Open source</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Free software: low cost, portable, customizable, vendor-independent</li>
<li>Widely used programming language, is easily installable and integrates with the rich and growing scientific Python ecosystem</li>
<li>Reproducible and collaborative research</li>
<li>Auto-differentiation: inverse design of photonic structures and metamaterials with improved performances and explore intriguing effects</li>
</ul>
</div><div class="column" style="width:50%;">
<iframe src="projects_stats.html" style="width:600px;height:600px;">
</iframe>
</div></div>
</section>
<section id="get-the-code" class="slide level2">
<h2>Get the code</h2>
<ul>
<li>Development on gitlab: continuous integration for testing and documentation deployment</li>
<li>Install / fork it / run it online / report bugs!</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p>FEM</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install gyptis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge gyptis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>FMM</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install nannos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge nannos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>PWEM</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install protis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/gyptis-name.png" class="img" style="width:33.0%"></p>
<figcaption><a href="https://gyptis.gitlab.io">gyptis.gitlab.io</a></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/nannos-name.png" class="img" style="width:33.0%"></p>
<figcaption><a href="https://nannos.gitlab.io">nannos.gitlab.io</a></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="fig/protis-name.png" class="img" style="width:33.0%"></p>
<figcaption><a href="https://protis.gitlab.io">protis.gitlab.io</a></figcaption>
</figure>
</div>
</div></div>
</section>
<section id="freeware-list" class="slide level2">
<h2>Freeware list</h2>
<p><a href="https://github.com/joamatab/awesome_photonics">https://github.com/joamatab/awesome_photonics</a></p>
<iframe src="https://bvial.info/awesome_photonics/" style="width:100%;height:100%;">
</iframe>
</section></section>
<section id="thank-you" class="title-slide slide level1 center" data-background-color="var(--quarto-scss-export-primary-color)">
<h1>Thank you!</h1>

</section>

<section>
<section id="appendix" class="title-slide slide level1 center" data-background-color="var(--quarto-scss-export-secondary-color)">
<h1>Appendix</h1>

</section>
<section id="bibliography" class="slide level2 smaller scrollable">
<h2>Bibliography</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-aageGigavoxelComputationalMorphogenesis2017" class="csl-entry" role="listitem">
Aage, Niels, Erik Andreassen, Boyan S. Lazarov, and Ole Sigmund. 2017. <span>“Giga-Voxel Computational Morphogenesis for Structural Design.”</span> <em>Nature</em> 550 (7674): 84–86. <a href="https://doi.org/10.1038/nature23911">https://doi.org/10.1038/nature23911</a>.
</div>
<div id="ref-alnaesFEniCSProjectVersion2015" class="csl-entry" role="listitem">
Alnæs, Martin, Jan Blechta, Johan Hake, August Johansson, Benjamin Kehlet, Anders Logg, Chris Richardson, Johannes Ring, Marie E. Rognes, and Garth N. Wells. 2015. <span>“The <span>FEniCS Project Version</span> 1.5.”</span> <em>Archive of Numerical Software</em> 3 (100). <a href="https://doi.org/10.11588/ans.2015.100.20553">https://doi.org/10.11588/ans.2015.100.20553</a>.
</div>
<div id="ref-bendsoeMaterialInterpolationSchemes1999" class="csl-entry" role="listitem">
Bendsøe, M. P., and O. Sigmund. 1999. <span>“Material Interpolation Schemes in Topology Optimization.”</span> <em>Arch. Appl. Mech. Ing. Arch.</em> 69 (9-10): 635–54. <a href="https://doi.org/10.1007/s004190050248">https://doi.org/10.1007/s004190050248</a>.
</div>
<div id="ref-bleyer2018numericaltours" class="csl-entry" role="listitem">
Bleyer, Jeremy. 2018. <em>Numerical Tours of Computational Mechanics with <span>FEniCS</span></em>. Manual. <span>Zenodo</span>. <a href="https://doi.org/10.5281/zenodo.1287832">https://doi.org/10.5281/zenodo.1287832</a>.
</div>
<div id="ref-jax2018github" class="csl-entry" role="listitem">
Bradbury, James, Roy Frostig, Peter Hawkins, Matthew James Johnson, Chris Leary, Dougal Maclaurin, George Necula, et al. 2018. <span>“<span>JAX</span>: Composable Transformations of <span>Python</span>+<span>NumPy</span> Programs.”</span>
</div>
<div id="ref-geuzaineGmsh3DFinite2009" class="csl-entry" role="listitem">
Geuzaine, Christophe, and Jean-François Remacle. 2009. <span>“Gmsh: <span>A</span> 3-<span>D</span> Finite Element Mesh Generator with Built-in Pre- and Post-Processing Facilities.”</span> <em>Int J Numer Meth Engng</em> 79 (11): 1309–31. <a href="https://doi.org/10.1002/nme.2579">https://doi.org/10.1002/nme.2579</a>.
</div>
<div id="ref-granet1996" class="csl-entry" role="listitem">
Granet, G., and B. Guizal. 1996. <span>“Efficient Implementation of the Coupled-Wave Method for Metallic Lamellar Gratings in <span>TM</span> Polarization.”</span> <em>JOSA A</em> 13 (5): 1019–23. <a href="https://doi.org/10.1364/JOSAA.13.001019">https://doi.org/10.1364/JOSAA.13.001019</a>.
</div>
<div id="ref-griewankEvaluatingDerivatives2008" class="csl-entry" role="listitem">
Griewank, Andreas, and Andrea Walther. 2008. <em>Evaluating <span>Derivatives</span></em>. Other <span>Titles</span> in <span>Applied Mathematics</span>. <span>Society for Industrial and Applied Mathematics</span>. <a href="https://doi.org/10.1137/1.9780898717761">https://doi.org/10.1137/1.9780898717761</a>.
</div>
<div id="ref-harris2020array" class="csl-entry" role="listitem">
Harris, Charles R., K. Jarrod Millman, Stéfan J. van der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, et al. 2020. <span>“Array Programming with <span>NumPy</span>.”</span> <em>Nature</em> 585 (7825): 357–62. <a href="https://doi.org/10.1038/s41586-020-2649-2">https://doi.org/10.1038/s41586-020-2649-2</a>.
</div>
<div id="ref-husseinReducedBlochMode2009" class="csl-entry" role="listitem">
Hussein, Mahmoud I. 2009. <span>“Reduced <span>Bloch</span> Mode Expansion for Periodic Media Band Structure Calculations.”</span> <em>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</em> 465 (2109): 2825–48. <a href="https://doi.org/10.1098/rspa.2008.0471">https://doi.org/10.1098/rspa.2008.0471</a>.
</div>
<div id="ref-johnsonNLoptNonlinearoptimizationPackage" class="csl-entry" role="listitem">
Johnson, Steven G. 2007. <span>“The <span>NLopt</span> Nonlinear-Optimization Package.”</span> <a href="https://github.com/stevengj/nlopt" class="uri">https://github.com/stevengj/nlopt</a>.
</div>
<div id="ref-lalanne1996" class="csl-entry" role="listitem">
Lalanne, Philippe, and G. Michael Morris. 1996. <span>“Highly Improved Convergence of the Coupled-Wave Method for <span>TM</span> Polarization.”</span> <em>Journal of the Optical Society of America A</em> 13 (4): 779–84.
</div>
<div id="ref-lazarovFiltersTopologyOptimization2011" class="csl-entry" role="listitem">
Lazarov, B. S., and O. Sigmund. 2011. <span>“Filters in Topology Optimization Based on <span class="nocase">Helmholtz-type</span> Differential Equations.”</span> <em>International Journal for Numerical Methods in Engineering</em> 86 (6): 765–81. <a href="https://doi.org/10.1002/nme.3072">https://doi.org/10.1002/nme.3072</a>.
</div>
<div id="ref-liuS4FreeElectromagnetic2012" class="csl-entry" role="listitem">
Liu, Victor, and Shanhui Fan. 2012. <span>“S4 : <span>A</span> Free Electromagnetic Solver for Layered Periodic Structures.”</span> <em>Computer Physics Communications</em> 183 (10): 2233–44. <a href="https://doi.org/10.1016/j.cpc.2012.04.026">https://doi.org/10.1016/j.cpc.2012.04.026</a>.
</div>
<div id="ref-maclaurin2015autograd" class="csl-entry" role="listitem">
Maclaurin, Dougal, David Duvenaud, and Ryan P Adams. 2015. <span>“Autograd: <span>Effortless</span> Gradients in Numpy.”</span> In <em><span>ICML</span> 2015 <span>AutoML</span> Workshop</em>, 238:5.
</div>
<div id="ref-mituschDolfinadjoint2018Automated2019" class="csl-entry" role="listitem">
Mitusch, Sebastian K., Simon W. Funke, and Jørgen S. Dokken. 2019. <span>“Dolfin-Adjoint 2018.1: Automated Adjoints for <span>FEniCS</span> and <span>Firedrake</span>.”</span> <em>Journal of Open Source Software</em> 4 (38): 1292. <a href="https://doi.org/10.21105/joss.01292">https://doi.org/10.21105/joss.01292</a>.
</div>
<div id="ref-moleskyInverseDesignNanophotonics2018" class="csl-entry" role="listitem">
Molesky, Sean, Zin Lin, Alexander Y. Piggott, Weiliang Jin, Jelena Vucković, and Alejandro W. Rodriguez. 2018. <span>“Inverse Design in Nanophotonics.”</span> <em>Nature Photonics</em> 12 (11): 659–70. <a href="https://doi.org/10.1038/s41566-018-0246-9">https://doi.org/10.1038/s41566-018-0246-9</a>.
</div>
<div id="ref-paszke2017automatic" class="csl-entry" role="listitem">
Paszke, Adam, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer. 2017. <span>“Automatic Differentiation in <span>PyTorch</span>.”</span> In <em><span>NIPS-W</span></em>.
</div>
<div id="ref-NEURIPS2019_9015" class="csl-entry" role="listitem">
Paszke, Adam, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, et al. 2019. <span>“<span>PyTorch</span>: <span>An</span> Imperative Style, High-Performance Deep Learning Library.”</span> In <em>Advances in Neural Information Processing Systems 32</em>, edited by H. Wallach, H. Larochelle, A. Beygelzimer, F. dAlché-Buc, E. Fox, and R. Garnett, 8024–35. <span>Curran Associates, Inc.</span>
</div>
<div id="ref-sigmundGeometricPropertiesOptimal2008" class="csl-entry" role="listitem">
Sigmund, Ole, and Kristian Hougaard. 2008. <span>“Geometric <span>Properties</span> of <span>Optimal Photonic Crystals</span>.”</span> <em>Physical Review Letters</em> 100 (15): 153904. <a href="https://doi.org/10.1103/PhysRevLett.100.153904">https://doi.org/10.1103/PhysRevLett.100.153904</a>.
</div>
<div id="ref-svanbergClassGloballyConvergent" class="csl-entry" role="listitem">
Svanberg, Krister. 2002. <span>“A Class of Globally Convergent Optimization Methods Based on Conservative Convex Separable Approximations.”</span> <em>SIAM Journal on Optimization</em> 12 (2): 555–73. <a href="https://doi.org/10.1137/S1052623499362822">https://doi.org/10.1137/S1052623499362822</a>.
</div>
<div id="ref-gyptis042" class="csl-entry" role="listitem">
Vial, Benjamin. 2022. <span>“Gyptis.”</span> Zenodo. <a href="https://doi.org/10.5281/zenodo.6636134">https://doi.org/10.5281/zenodo.6636134</a>.
</div>
<div id="ref-vial2022" class="csl-entry" role="listitem">
Vial, Benjamin, and Yang Hao. 2022. <span>“Open-<span>Source Computational Photonics</span> with <span>Auto Differentiable Topology Optimization</span>.”</span> <em>Mathematics</em> 10 (20): 3912. <a href="https://doi.org/10.3390/math10203912">https://doi.org/10.3390/math10203912</a>.
</div>
<div id="ref-vialOptimizationExperimentalValidation2022" class="csl-entry" role="listitem">
Vial, Benjamin, Tom Whittaker, Shiyu Zhang, William G. Whittow, and Yang Hao. 2022. <span>“Optimization and Experimental Validation of a Bi-Focal Lens in the Microwave Domain.”</span> <em>AIP Advances</em> 12 (2): 025103. <a href="https://doi.org/10.1063/5.0074062">https://doi.org/10.1063/5.0074062</a>.
</div>
<div id="ref-2020SciPy-NMeth" class="csl-entry" role="listitem">
Virtanen, Pauli, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, et al. 2020. <span>“<span>SciPy</span> 1.0: <span>Fundamental</span> Algorithms for Scientific Computing in Python.”</span> <em>Nature Methods</em> 17: 261–72. <a href="https://doi.org/10.1038/s41592-019-0686-2">https://doi.org/10.1038/s41592-019-0686-2</a>.
</div>
<div id="ref-wangProjectionMethodsConvergence2010" class="csl-entry" role="listitem">
Wang, Fengwen, Boyan Stefanov Lazarov, and Ole Sigmund. 2010. <span>“On Projection Methods, Convergence and Robust Formulations in Topology Optimization.”</span> <em>Struct Multidisc Optim</em> 43 (6): 767–84. <a href="https://doi.org/10.1007/s00158-010-0602-y">https://doi.org/10.1007/s00158-010-0602-y</a>.
</div>
<div id="ref-whittakerScatteringmatrixTreatmentPatterned1999" class="csl-entry" role="listitem">
Whittaker, D. M., and I. S. Culshaw. 1999. <span>“Scattering-Matrix Treatment of Patterned Multilayer Photonic Structures.”</span> <em>Physical Review B</em> 60 (4): 2610–18. <a href="https://doi.org/10.1103/PhysRevB.60.2610">https://doi.org/10.1103/PhysRevB.60.2610</a>.
</div>
</div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 1,

        maxScale: 1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/benvial\.github\.io\/webinaire_GDR\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>